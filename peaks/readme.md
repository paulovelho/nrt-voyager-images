# generate Peaks

## basic wavesurfer data:

Amazing as it is, wavesurfer still has some issues to generate peaks inside google chrome.
So we cheat: we pre-render peaks and send to the application an mp3 file and an array with peaks


to do so, we use audiowaveform to generate peaks:
[https://github.com/bbc/audiowaveform](https://github.com/bbc/audiowaveform)


```
audiowaveform -i audios/v1-1.mp3 -o peaks/v1-1.json --pixels-per-second 20 --bits 8
```

## Audacity export
`audiowaveform` is amazing, but the amount of information we're trying to extract from a sound file is too much.

The solution was to manually split and trim the .wav using audacity.

After detecting the image waves (there's another full explanation about how to find them), I exported following the rules
On `Tools > Sample Data Export...`
- Limit output to first: (minimum of 196608, that is the average image size in pixels)
- Measurement Scale: Linear
- Index: Time indexed
- Include header information: None

## python treatment
inside `peaks` there is a python script that will grab information from the audacity export and create files for wavesurfer usage and for image generation.

usage:
```
python fix-json.py [file] [time] [start] [end]
```
[file] = txt file generated by audacity *
[time] = time of the audio (ms) *
[start] = time where image starts (ms) / default: 0
[end] = time where image ends (ms) / default: [time]


